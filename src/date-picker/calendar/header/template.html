<div [class]="bem.element('container')">
  <div>
    @if (dateNavRange !== DateNavRange.Decade) {
      <ng-container
        [ngTemplateOutlet]="yearControl"
        [ngTemplateOutletContext]="{ side: 'left' }"
      ></ng-container>
    }

    @if (dateNavRange === DateNavRange.Decade) {
      <ng-container
        [ngTemplateOutlet]="decadeControl"
        [ngTemplateOutletContext]="{ side: 'left' }"
      ></ng-container>
    }
  </div>
  <!-- 内容区 -->
  @if (dateNavRange === DateNavRange.Month) {
    <span
      [class]="bem.element('nav-content')"
      >
      <ng-container
        [ngTemplateOutlet]="$monthBeforeYear() ? monthTemplate : yearTemplate"
      ></ng-container>
      <div class="separator"></div>
      <ng-container
        [ngTemplateOutlet]="$monthBeforeYear() ? yearTemplate : monthTemplate"
      ></ng-container>
    </span>
  }

  @if (dateNavRange === DateNavRange.Year) {
    <span
      [class]="bem.element('nav-content')"
      >
      <button
        aui-button="text"
        (click)="clickNav(DateNavRange.Year)"
        >
        {{ $headerRange().start.year }}
      </button>
    </span>
  }

  @if (dateNavRange === DateNavRange.Decade) {
    <span
      [class]="bem.element('nav-content')"
      >
      {{ $headerRange().start.year }} - {{ $headerRange().end.year }}
    </span>
  }

  <div [class]="bem.element('nav-action')">
    @if (dateNavRange !== DateNavRange.Decade) {
      <ng-container
        [ngTemplateOutlet]="yearControl"
        [ngTemplateOutletContext]="{ side: 'right' }"
      ></ng-container>
    }

    @if (dateNavRange === DateNavRange.Decade) {
      <ng-container
        [ngTemplateOutlet]="decadeControl"
        [ngTemplateOutletContext]="{ side: 'right' }"
      ></ng-container>
    }
  </div>
</div>

<ng-template
  #yearControl
  let-side="side"
  >
  <span class="action-bar">
    @if (side === 'right') {
      <button
        aui-button="text"
        size="mini"
        [square]="true"
      [class.hidden]="
        !shouldShowNav(DateNavRange.Month, side) ||
        dateNavRange !== DateNavRange.Month
      "
        (click)="navHead(DateNavRange.Month, 1)"
        >
        <aui-icon icon="angle_right"></aui-icon>
      </button>
    }
    <button
      aui-button="text"
      size="mini"
      [square]="true"
      (click)="navHead(DateNavRange.Year, side === 'left' ? -1 : 1)"
      [class.hidden]="!shouldShowNav(DateNavRange.Year, side)"
      >
      <aui-icon
        [icon]="side === 'left' ? 'angles_left' : 'angles_right'"
      ></aui-icon>
    </button>
    @if (side === 'left') {
      <button
        aui-button="text"
        size="mini"
        [square]="true"
      [class.hidden]="
        !shouldShowNav(DateNavRange.Month, side) ||
        dateNavRange !== DateNavRange.Month
      "
        (click)="navHead(DateNavRange.Month, -1)"
        >
        <aui-icon icon="angle_left"></aui-icon>
      </button>
    }
  </span>
</ng-template>

<ng-template
  #decadeControl
  let-side="side"
  >
  <button
    aui-button="text"
    size="mini"
    [square]="true"
    (click)="navHead(DateNavRange.Decade, side === 'left' ? -10 : 10)"
    [class.hidden]="!shouldShowNav(DateNavRange.Decade, side)"
    >
    <aui-icon
      [icon]="side === 'left' ? 'angles_left' : 'angles_right'"
    ></aui-icon>
  </button>
</ng-template>

<ng-template #yearTemplate>
  <button
    aui-button="text"
    class="header-range"
    (click)="clickNav(DateNavRange.Year)"
    >
    {{ $headerRange().start.year }}
  </button>
</ng-template>
<ng-template #monthTemplate>
  <button
    aui-button="text"
    class="header-range"
    (click)="clickNav(DateNavRange.Month)"
    >
    {{ $headerRange().start.month }}
  </button>
</ng-template>
